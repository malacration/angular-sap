<h1>Import Csv</h1>
<input type="file" (change)="onFileSelect($event.target)" />
<button (click)="carregarCsv()">Enviar</button>
<button (click)="limpar()">Ver PN Inconsistentes</button>
<button (click)="limpar()">Remover Nfs cadastradas</button>
<hr>
<h2>Dados Para importação</h2>
<h3>Total: {{totalDados() | currency }}</h3>

<button (click)="validarParceiro()">Validar Fornecedor</button>
<button (click)="validarCliente()">Validar Cliente</button>
<div class="center">
    <div class="card text-center" *ngFor="let pn of currentPage">
        <div class="card-header">
            {{pn.cpfCnpj}} - {{pn.codSap}} - total : {{pn.getTotais() | currency}} 
            <span *ngIf="pn.error" (click)="showErro(pn)">{{pn.error}}</span>
            <button (click)="cadastrarNfEntrada(pn)"> Lançar NFs - Entrada </button> 
            <button (click)="cadastrarNfSaida(pn)"> Lançar NFs - Saida </button> 
            <button (click)="pn.isCollapsed = ! pn.isCollapsed">Colapsar</button>
        </div>
        <div style="margin: 5px;" class="card-body" *ngFor="let nf of pn.documentosFiscais" #collapse="ngbCollapse" [(ngbCollapse)]="pn.isCollapsed">
            Nota - {{nf.numeroDocumento}} - {{nf.getTotais() | currency}}
            <div style="margin-left: 5px;" *ngFor="let parcela of nf.parcelas">
                Parcelas - R$: {{parcela.valor}} - {{parcela.dataVencimento | date: 'dd/MM/yyyy'}} 
            </div>
        </div>
    </div>
    <ngb-pagination (pageChange)="loadPage(page)" [collectionSize]="dados.length" [pageSize]="itemsPerPage" [(page)]="page" aria-label="Default pagination"></ngb-pagination>
</div>
<!-- <p><ngb-progressbar type="success" [value]="progression"></ngb-progressbar></p> -->
<div class="row g-3">
    <div class="col-md-6">
        <button (click)="cadastrarAllNfEntrada()">Importar Notas fiscais de Entrada</button>
    </div>
    <div class="col-md-6">
        <button (click)="cadastrarAllNfSaida()">Importar Notas fiscais de Saida</button>
    </div>
</div>