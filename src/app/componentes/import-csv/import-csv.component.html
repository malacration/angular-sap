<head>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.9.1/font/bootstrap-icons.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/themes/prism.css" />
</head>
<h1>Import Csv</h1>
<input type="file" (change)="onFileSelect($event.target)" />
<button (click)="carregarCsv()">Enviar</button>
<button (click)="limpar()">Ver PN Inconsistentes</button>
<button (click)="limpar()">Remover Nfs cadastradas</button>
<hr>
<h2>Dados Para importação</h2>
<h3>Total: {{totalDados() | currency }}</h3>

<button (click)="validarParceiro()">Validar Fornecedor</button>
<button (click)="validarCliente()">Validar Cliente</button>
<div class="card" *ngFor="let pn of dados">
    <div class="card-header">
        {{pn.cpfCnpj}} - {{pn.codSap}} - total : {{pn.getTotais() | currency}} 
        <span *ngIf="pn.error" (click)="showErro(pn)">{{pn.error}}</span>
        <button (click)="cadastrarNfEntrada(pn)"> Entrada </button> 
        <button (click)="cadastrarNfSaida(pn)"> Saida </button> 
        <button (click)="pn.isCollapsed = ! pn.isCollapsed">Colapsar</button>
    </div>
    <div style="margin: 5px;" class="card-body" *ngFor="let nf of pn.documentosFiscais" #collapse="ngbCollapse" [(ngbCollapse)]="pn.isCollapsed">
        Nota - {{nf.numeroDocumento}} - {{nf.getTotais() | currency}}
        <div style="margin-left: 5px;" *ngFor="let parcela of nf.parcelas">
            Parcelas - R$: {{parcela.valor}} - {{parcela.dataVencimento | date: 'dd/MM/yyyy'}} 
        </div>
    </div>
</div>

<button (click)="cadastrarAllNfEntrada()">Importar Notas fiscais de Entrada</button>
<button (click)="cadastrarAllNfSaida()">Importar Notas fiscais de Saida</button>